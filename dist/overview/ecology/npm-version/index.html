<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/black-node-guidebook/umi.css" />
    <script>
      window.routerBase = "/black-node-guidebook/";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>npm 版本控制 - Node Guidebook</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/overview/ecology/npm-version" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/node-guidebook-favicon.svg&#x27;)" href="/black-node-guidebook//">Node Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a aria-current="page" class="active" href="/black-node-guidebook//overview">概览</a></span><span><a href="/black-node-guidebook//engine">引擎</a></span><span><a href="/black-node-guidebook//system">系统</a></span><span><a href="/black-node-guidebook//network">网络</a></span><span><a href="/black-node-guidebook//server-application">服务端应用</a></span><span><a href="/black-node-guidebook//util-application">工具应用</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/yyt520/black-node-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/node-guidebook-favicon.svg&#x27;)" href="/black-node-guidebook//"></a><h1>Node Guidebook</h1><p>Node 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a aria-current="page" class="active" href="/black-node-guidebook//overview">概览</a></li><li><a href="/black-node-guidebook//engine">引擎</a></li><li><a href="/black-node-guidebook//system">系统</a></li><li><a href="/black-node-guidebook//network">网络</a></li><li><a href="/black-node-guidebook//server-application">服务端应用</a></li><li><a href="/black-node-guidebook//util-application">工具应用</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/yyt520/black-node-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a target="_blank" rel="noopener noreferrer">架构</a><ul><li><a href="/black-node-guidebook//overview/basic"><span>概览</span></a></li><li><a href="/black-node-guidebook//overview/basic/execution"><span>运行机制</span></a></li><li><a href="/black-node-guidebook//overview/basic/memory"><span>内存控制</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">模块机制</a><ul><li><a href="/black-node-guidebook//overview/module/commonjs"><span>CommonJS</span></a></li><li><a href="/black-node-guidebook//overview/module/module"><span>模块机制</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">生态</a><ul><li><a href="/black-node-guidebook//overview/ecology/npm-package-json"><span>npm 包描述文件</span></a></li><li><a aria-current="page" class="active" href="/black-node-guidebook//overview/ecology/npm-version"><span>npm 版本控制</span></a></li><li><a href="/black-node-guidebook//overview/ecology/npm-command"><span>npm 脚本命令</span></a></li><li><a href="/black-node-guidebook//overview/ecology/npm-configuration"><span>npm 配置文件</span></a></li><li><a href="/black-node-guidebook//overview/ecology/npx"><span>npx</span></a></li><li><a href="/black-node-guidebook//overview/ecology/nvm"><span>nvm</span></a></li><li><a href="/black-node-guidebook//overview/ecology/nrm"><span>nrm</span></a></li><li><a href="/black-node-guidebook//overview/ecology/yarn"><span>yarn</span></a></li><li><a href="/black-node-guidebook//overview/ecology/cnpm"><span>cnpm</span></a></li><li><a href="/black-node-guidebook//overview/ecology/pnpm"><span>pnpm</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="查看依赖包版本" data-depth="2"><a href="/black-node-guidebook//overview/ecology/npm-version#查看依赖包版本"><span>查看依赖包版本</span></a></li><li title="语义化版本规范" data-depth="2"><a href="/black-node-guidebook//overview/ecology/npm-version#语义化版本规范"><span>语义化版本规范</span></a></li><li title="标准版本" data-depth="3"><a href="/black-node-guidebook//overview/ecology/npm-version#标准版本"><span>标准版本</span></a></li><li title="先行版本" data-depth="3"><a href="/black-node-guidebook//overview/ecology/npm-version#先行版本"><span>先行版本</span></a></li><li title="版本号标签" data-depth="3"><a href="/black-node-guidebook//overview/ecology/npm-version#版本号标签"><span>版本号标签</span></a></li><li title="版本号大小比较" data-depth="3"><a href="/black-node-guidebook//overview/ecology/npm-version#版本号大小比较"><span>版本号大小比较</span></a></li><li title="版本工具使用" data-depth="2"><a href="/black-node-guidebook//overview/ecology/npm-version#版本工具使用"><span>版本工具使用</span></a></li><li title="依赖版本管理" data-depth="2"><a href="/black-node-guidebook//overview/ecology/npm-version#依赖版本管理"><span>依赖版本管理</span></a></li><li title="锁定依赖版本" data-depth="2"><a href="/black-node-guidebook//overview/ecology/npm-version#锁定依赖版本"><span>锁定依赖版本</span></a></li><li title="定期更新依赖" data-depth="2"><a href="/black-node-guidebook//overview/ecology/npm-version#定期更新依赖"><span>定期更新依赖</span></a></li><li title="依赖版本控制的最佳实践" data-depth="2"><a href="/black-node-guidebook//overview/ecology/npm-version#依赖版本控制的最佳实践"><span>依赖版本控制的最佳实践</span></a></li><li title="参考资料" data-depth="2"><a href="/black-node-guidebook//overview/ecology/npm-version#参考资料"><span>参考资料</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="npm-版本控制"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#npm-版本控制"><span class="icon icon-link"></span></a>npm 版本控制</h1><h2 id="查看依赖包版本"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#查看依赖包版本"><span class="icon icon-link"></span></a>查看依赖包版本</h2><p>通过执行以下命令能够查看某个依赖包的最新版本。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查看某个 package 的注册信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> view </span><span class="token operator">&lt;</span><span class="token plain">package-name</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看某个 package 的最新版本</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> view </span><span class="token operator">&lt;</span><span class="token plain">package-name</span><span class="token operator">&gt;</span><span class="token plain"> version</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看某个 package 在 npm 服务器上所发布过的版本</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> view </span><span class="token operator">&lt;</span><span class="token plain">package-name</span><span class="token operator">&gt;</span><span class="token plain"> versions</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看仓库依赖树上所有包的版本信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> </span><span class="token function">ls</span></div></pre></div><h2 id="语义化版本规范"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#语义化版本规范"><span class="icon icon-link"></span></a>语义化版本规范</h2><p>npm 中的包模块版本都需要遵循 <a target="_blank" rel="noopener noreferrer" href="https://semver.org/">SemVer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（Semantic Version，语义化版本）规范，这是由 Github 起草的一个具有指导意义的，统一的版本号表示规则。</p><h3 id="标准版本"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#标准版本"><span class="icon icon-link"></span></a>标准版本</h3><p>SemVer 规范的标准版本号采用 <code>X.Y.Z</code> 的格式，其中 X、Y 和 Z 为非负的整数，且禁止在数字前方补零。X 是主版本号、Y 是次版本号、而 Z 为修订号。每个元素必须以数值来递增。</p><ul><li>主版本号（major）：当你做了不兼容的 API 修改</li><li>次版本号（minor）：当你做了向下兼容的功能性新增</li><li>修订号（patch）：当你做了向下兼容的问题修正。</li></ul><p>版本是严格递增的，例如：16.2.0 -&gt; 16.2.1 -&gt; 16.3.0 -&gt; 16.4.0</p><h3 id="先行版本"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#先行版本"><span class="icon icon-link"></span></a>先行版本</h3><p>当某个版本改动比较大、并非稳定而且可能无法满足预期的兼容性需求时，你可能要先发布一个先行版本。</p><p>先行版本的格式是在修订版本号后面加上一个连接号（<code>-</code>），再加上一连串以点（<code>.</code>）分割的标识符，标识符可以由英文、数字和连接号（<code>[0-9A-Za-z]</code>）组成。</p><p>例如：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 格式</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">major.minor.patch-</span><span class="token punctuation">{</span><span class="token plain">identifier</span><span class="token punctuation">}</span><span class="token plain">.</span><span class="token punctuation">{</span><span class="token plain">identifier</span><span class="token punctuation">}</span><span class="token plain">.</span><span class="token punctuation">{</span><span class="token plain">identifier</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 示例 1：通常第一个 identifier 为版本号标签，关于版本号标签请看下文</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 常用于先行版本的版本号标签是 beta、rc、experimental</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token number">1.0</span><span class="token plain">.3-alpha.1</span></div></pre></div><h3 id="版本号标签"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#版本号标签"><span class="icon icon-link"></span></a>版本号标签</h3><p>常用的版本号标签如下：</p><div class="__dumi-default-table"><div class="__dumi-default-table-content"><table><thead><tr><th align="left">版本号标签</th><th align="left">语义</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">latest</td><td align="left">默认</td><td align="left">不指定版本情况下默认安装的最新版本</td></tr><tr><td align="left">alpha</td><td align="left">内测</td><td align="left">内部测试版，一般不向外部发布，会有很多 BUG，一般只有测试人员使用</td></tr><tr><td align="left">beta</td><td align="left">公测</td><td align="left">也是测试版本，这个阶段的版本会一直加入新的功能，在 Alpha 版之后推出</td></tr><tr><td align="left">next</td><td align="left">下一个</td><td align="left"></td></tr><tr><td align="left">rc</td><td align="left">候选</td><td align="left">Release Candidate 系统平台上就是发行候选版本。RC 版不会再加入新的功能了，主要着重于除错</td></tr><tr><td align="left">experimental</td><td align="left">实验</td><td align="left"></td></tr></tbody></table></div></div><p>给版本号添加标签的方式有两种：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 第一种方式：在发布时指定标签</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 1. version-tag 替换为版本号标签的名称</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> publish --tag </span><span class="token operator">&lt;</span><span class="token plain">version-tag</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 示例</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> publish --tag next react@18.0.0</span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> publish --tag experimental vue@3.2.0</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 第二种方式：发布后执行以下命令</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 1. package-name 替换为 npm 包名字</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 2. version 替换为 npm 包的指定版本</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 3. version-tag 替换为版本号标签的名称</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> dist-tag </span><span class="token function">add</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">package-name</span><span class="token operator">&gt;</span><span class="token plain">@</span><span class="token operator">&lt;</span><span class="token plain">version</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">version-tag</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 示例</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> dist-tag </span><span class="token function">add</span><span class="token plain"> react@18.0.0 alpha</span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> dist-tag </span><span class="token function">add</span><span class="token plain"> vue@3.2.0 next</span></div></pre></div><h3 id="版本号大小比较"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#版本号大小比较"><span class="icon icon-link"></span></a>版本号大小比较</h3><p>格式：<code>major.minor.patch-[pre-release]+[build-metadata]</code></p><p>版本号大小比较是从左往右依次比较 major、minor、patch、pre-release。build-metadata 对优先级无影响。</p><p>现行版本优先级低于正式版本，如：</p><ul><li><code>1.0.1-alpha.1 &lt; 1.0.1</code></li><li><code>1.0.0-alpha.1 &lt; 1.0.0-beta &lt; 1.0.0</code></li></ul><blockquote><p>版本号大小与发版时间有关系吗？答案是 <strong>没有关系</strong>。</p></blockquote><p>例如：依次发布 <code>1.0.0-alpha.1</code>、<code>1.0.0-alpha.3</code>、<code>1.0.0-alpha.2</code>。用户安装了 <code>1.0.0-alpha.1</code>，此时升级版本会安装 <code>1.0.0-alpha.3</code>。</p><blockquote><p>版本号升级与标签之间的关系？</p></blockquote><p>执行 <code>npm install &lt;package-name&gt;</code> 或 <code>npm update &lt;package-name&gt;</code> 等同于执行 <code>npm install &lt;package-name&gt;@latest</code> 或 <code>npm update &lt;pacakge-name&gt;@latest</code>。用户当前版本低于 <code>latest</code> 标签下的最高版本，而低于其他标签下的版本时，会安装其他标签下的版本。</p><p>例如：</p><ul><li>用户安装了 <code>1.0.0-alpha.1</code>（alpha），此时发布了 <code>1.0.0</code>（latest），用户升级后的版本是 <code>1.0.0</code>（latest）</li><li>用户安装了 <code>1.0.0-alpha.1</code>（alpha），此时发布 <code>1.0.0-beta.0</code>（beta），用户升级后的版本时 <code>1.0.0-beta.0</code>（beta）</li><li>用户安装了 <code>1.0.0</code>（latest），此时发布了 <code>2.0.0-alpha.1</code>（alpha），用户升级后的版本不变，仍然是 <code>1.0.0</code>（latest）</li></ul><h2 id="版本工具使用"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#版本工具使用"><span class="icon icon-link"></span></a>版本工具使用</h2><p>在开发中肯定少不了对一些版本号的操作，如果这些版本号符合 SemVer 规范 ，我们可以借助用于操作版本的 npm 包 semver 来帮助我们进行比较版本大小、提取版本信息等操作。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 安装工具</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> semver</span></div></pre></div><p>具体用法示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// 比较版本号大小</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">gt</span><span class="token punctuation">(</span><span class="token string">&#x27;1.2.3&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;9.8.7&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// false</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">lt</span><span class="token punctuation">(</span><span class="token string">&#x27;1.2.3&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;9.8.7&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// true</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 判断版本号是否符合规范，返回解析后符合规范的版本号</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">valid</span><span class="token punctuation">(</span><span class="token string">&#x27;1.2.3&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// &#x27;1.2.3&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">valid</span><span class="token punctuation">(</span><span class="token string">&#x27;a.b.c&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// null</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 将其他版本号强制转换成 semver 版本号</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">valid</span><span class="token punctuation">(</span><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">coerce</span><span class="token punctuation">(</span><span class="token string">&#x27;v2&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// &#x27;2.0.0&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">valid</span><span class="token punctuation">(</span><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">coerce</span><span class="token punctuation">(</span><span class="token string">&#x27;42.6.7.9.3-alpha&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// &#x27;42.6.7&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 一些其他用法</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">clean</span><span class="token punctuation">(</span><span class="token string">&#x27;  =v1.2.3 &#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// &#x27;1.2.3&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">satisfies</span><span class="token punctuation">(</span><span class="token string">&#x27;1.2.3&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;1.x || &gt;= 2.5.0 || 5.0.0 - 7.23&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// true</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">semver</span><span class="token punctuation">.</span><span class="token method function property-access">minVersion</span><span class="token punctuation">(</span><span class="token string">&#x27;&gt;=1.0.0&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// &#x27;1.8.0&#x27;</span></div></pre></div><p>更多关于 semver 用法，请查阅官网 <a target="_blank" rel="noopener noreferrer" href="https://github.com/npm/node-semver">https://github.com/npm/node-semver<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h2 id="依赖版本管理"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#依赖版本管理"><span class="icon icon-link"></span></a>依赖版本管理</h2><p>我们经常看到，在 <code>package.json</code> 中各种依赖的不同写法：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token string-property property">&quot;dependencies&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string-property property">&quot;signale&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;1.4.0&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string-property property">&quot;figlet&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string-property property">&quot;react&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;16.x&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string-property property">&quot;table&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;~5.4.6&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string-property property">&quot;yargs&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;^14.0.0&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><p>前三个容易理解：</p><ul><li><code>&quot;signale&quot;: &quot;1.4.0&quot;</code>：固定版本号</li><li><code>&quot;figlet&quot;: &quot;*&quot;</code>：任意版本号（即 <code>&gt;=0.0.0</code>）</li><li><code>&quot;react&quot;: &quot;16.x&quot;</code>：匹配主要版本（<code>&gt;=16.0.0 &lt; 17.0.0</code>）</li><li><code>&quot;react&quot;: &quot;16.3.x&quot;</code>：匹配主要版本和次要版本（<code>&gt;=16.3.0 &lt;16.4.0</code>）</li></ul><p>再看看后面两个，版本号包含 <code>~</code> 和 <code>^</code> 符号：</p><ul><li><code>~</code>：当安装依赖时获取到有最新版本时，安装到 <code>x.y.z</code> 中 <code>z</code> 的最新版本。即保持主版本号、次版本号不变的情况下，保持修订号的最新版本</li><li><code>^</code>：当安装依赖时获取到由最新版本时，安装到 <code>x.y.z</code> 中 <code>y</code> 和 <code>z</code> 都为最新版本。即保持主版本号不变的情况下，保持次版本号、修订版本号为最新版本。</li></ul><p>在 <code>package.json</code> 中最常见应该时 <code>&quot;yargs&quot;: &quot;^14.0.0&quot;</code> 这种格式的依赖，因为我们在使用 <code>npm install &lt;package-name&gt;</code> 安装包时，<code>npm</code> 默认安装当前最新版本，然后在所安装的版本号前加 <code>^</code> 号。</p><p>注意，当主版本号为 <code>0</code> 的情况，会被认为是一个不稳定版本，情况与上面不同：</p><ul><li>主版本号和次版本号都为 <code>0</code>: <code>^0.0.z</code>、<code>~0.0.z</code> 都被当作固定版本，安装依赖时均不会发生变化。 主版本号为 <code>0</code>: <code>^0.y.z</code> 表现和 <code>~0.y.z</code> 相同，只保持修订号为最新版本。</li></ul><blockquote><p><code>1.0.0</code> 的版本号用于界定公共 API。当你的软件发布到了正式环境，或者有稳定的 API 时，就可以发布 1.0.0 版本了。所以，当你决定对外部发布一个正式版本的 npm 包时，把它的版本标为 1.0.0。</p></blockquote><p>除此以外，还包含以下规则：</p><ul><li><code>&gt;</code>：接受高于指定版本的任何版本</li><li><code>&gt;=</code> 接受等于或高于指定版本的任何版本</li><li><code>&lt;=</code>：接受等于或低于指定版本的任何版本</li><li><code>&lt;</code>：接受低于指定版本的任何版本</li><li><code>=</code>：接受确切的版本</li><li><code>-</code>：接受一定范围的版本，例如 <code>2.1.0 - 2.6.2</code></li><li><code>||</code>：组合集合，例如 <code>&lt; 2.1 || &gt; 2.6</code></li></ul><p>可以合并其中一些符号，例如 <code>1.0.0 || &gt;= 1.1.0 &lt; 1.2.0</code> 即使用 1.0.0 或从 1.1.0 开始但低于 1.2.0 的版本。</p><h2 id="锁定依赖版本"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#锁定依赖版本"><span class="icon icon-link"></span></a>锁定依赖版本</h2><p>实际开发中，经常会因为各种依赖不一致而产生奇怪的问题，或者在某些场景下，我们不希望依赖被更新，建议在开发中使用 package-lock.json。</p><p>锁定依赖版本意味着在我们不手动执行更新的情况下，每次安装依赖都会安装固定版本。保证整个团队使用版本号一致的依赖。</p><p>每次安装固定版本，无需计算依赖版本范围，大部分场景下能大大加速依赖安装时间。</p><p>使用 package-lock.json 要确保 npm 的版本在 5.6 以上，因为在 5.0 - 5.6 中间，对 package-lock.json 的处理逻辑进行过几次更新，5.6 版本后处理逻辑逐渐稳定。</p><p>关于 package-lock.json 详细的结构，我们会在后面的章节进行解析。</p><h2 id="定期更新依赖"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#定期更新依赖"><span class="icon icon-link"></span></a>定期更新依赖</h2><p>实际开发场景下，我们虽然不需要每次都去安装新的版本，仍然需要定时去升级依赖版本，来让我们享受依赖包升级带来的问题修复、性能提升、新特性更新。</p><p>使用 <code>npm outdated</code> 可以帮助我们列出哪些还没有升级到最新版本的依赖：</p><ul><li>黄色表示不符合我们指定的语意化版本范围 - 不需要升级</li><li>红色表示符合指定的语意化版本范围 - 需要升级</li></ul><p>执行 <code>npm update</code> 会升级所有的红色依赖。</p><h2 id="依赖版本控制的最佳实践"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#依赖版本控制的最佳实践"><span class="icon icon-link"></span></a>依赖版本控制的最佳实践</h2><h2 id="参考资料"><a aria-hidden="true" tabindex="-1" href="/black-node-guidebook//overview/ecology/npm-version#参考资料"><span class="icon icon-link"></span></a>参考资料</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://semver.org/lang/zh-CN/">语义化版本 2.0.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/yyt520/black-node-guidebook/edit/master/docs/overview/ecology/npm-version.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last update: ">2023/7/9 19:47:35</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/black-node-guidebook/umi.js"></script>
  </body>
</html>
